calcBetweenGroupsVariance <- function(variable,groupvariable) 
{
     # find out how many values the group variable can take
	groupvariable2 <- as.factor(groupvariable[[1]]) 
	levels <- levels(groupvariable2)
	numlevels <- length(levels)
	# calculate the overall grand mean:
	grandmean <- mean(variable)
	# get the mean and standard deviation for each group: 
	numtotal <- 0
	denomtotal <- 0
	for (i in 1:numlevels)
	{
		leveli <- levels[i]
		levelidata <- variable[groupvariable==leveli,] 
		levelilength <- length(levelidata)
		# get the mean and standard deviation for group i: 
		meani <- mean(levelidata)
		sdi <- sd(levelidata)
		numi <- levelilength * ((meani - grandmean)^2) 
		denomi <- levelilength
		numtotal <- numtotal + numi
		denomtotal <- denomtotal + denomi
	}
     # calculate the between-groups variance
	Vb <- numtotal / (numlevels - 1) 
	Vb <- Vb[[1]]
	return(Vb)
}